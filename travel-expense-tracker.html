<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ÊóÖË°åËÆ∞Ë¥¶AA - Êô∫ËÉΩÂàÜË¥¶Âä©Êâã</title>
    
    <!-- TDesign CSS -->
    <link href="https://cdn.jsdelivr.net/npm/tdesign@1.9.0/dist/tdesign.min.css" rel="stylesheet">
    
    <!-- Ëá™ÂÆö‰πâ CSS -->
    <link href="travel-expense-tracker.css" rel="stylesheet">
    
    <!-- ÂõæÊ†áÂ∫ì -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    
    <!-- PDF ÁîüÊàêÂ∫ì -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
</head>
<body>
    <!-- Â§¥ÈÉ® -->
    <header class="t-header">
        <div class="container">
            <h1><i class="fas fa-plane-departure"></i> ÊóÖË°åËÆ∞Ë¥¶AA</h1>
            <p>Êô∫ËÉΩÂàÜË¥¶Âä©ÊâãÔºåËÆ©ÊóÖË°åË¥¶ÂçïÊõ¥Ê∏ÖÊô∞</p>
        </div>
    </header>

    <div class="container">
        <!-- ÂØºËà™Ê†áÁ≠æ -->
        <t-tabs id="mainTabs" theme="card" value="travel">
            <t-tab-panel value="travel" label="ÂàõÂª∫ÊóÖË°å">
                <t-card title="ÂàõÂª∫Êñ∞ÊóÖË°å" class="travel-card">
                    <t-form id="travelForm" label-width="120px">
                        <t-form-item label="ÊóÖË°åÂêçÁß∞">
                            <t-input 
                                id="travelName" 
                                placeholder="‰æãÂ¶ÇÔºö‰∫ëÂçó‰∏ÉÊó•Ê∏∏" 
                                clearable
                            />
                        </t-form-item>
                        
                        <t-row :gutter="20">
                            <t-col :span="6">
                                <t-form-item label="ÂºÄÂßãÊó•Êúü">
                                    <t-date-picker 
                                        id="startDate" 
                                        theme="primary"
                                        placeholder="ÈÄâÊã©ÂºÄÂßãÊó•Êúü"
                                    />
                                </t-form-item>
                            </t-col>
                            <t-col :span="6">
                                <t-form-item label="ÁªìÊùüÊó•Êúü">
                                    <t-date-picker 
                                        id="endDate" 
                                        theme="primary"
                                        placeholder="ÈÄâÊã©ÁªìÊùüÊó•Êúü"
                                    />
                                </t-form-item>
                            </t-col>
                        </t-row>
                        
                        <t-form-item label="Ê∑ªÂä†ÊàêÂëò">
                            <t-input-group>
                                <t-input 
                                    id="memberInput" 
                                    placeholder="ËæìÂÖ•ÊâãÊú∫Âè∑ÊàñÈÇÆÁÆ±"
                                    clearable
                                />
                                <t-button theme="primary" onclick="addMember()">
                                    <template #icon><i class="fas fa-plus"></i></template>
                                    Ê∑ªÂä†
                                </t-button>
                            </t-input-group>
                        </t-form-item>
                        
                        <t-form-item label="ÊàêÂëòÂàóË°®">
                            <div id="membersList" class="members-list">
                                <t-empty description="ÊöÇÊó†ÊàêÂëò" />
                            </div>
                        </t-form-item>
                        
                        <t-form-item>
                            <t-button theme="success" size="large" onclick="createTravel()" block>
                                <template #icon><i class="fas fa-check"></i></template>
                                ÂàõÂª∫ÊóÖË°å
                            </t-button>
                        </t-form-item>
                    </t-form>
                </t-card>

                <!-- ÂΩìÂâçÊóÖË°å‰ø°ÊÅØ -->
                <t-card id="currentTravelCard" title="ÂΩìÂâçÊóÖË°å" style="display: none;">
                    <div id="currentTravelInfo"></div>
                </t-card>
            </t-tab-panel>

            <t-tab-panel value="expenses" label="ËÆ∞Ë¥¶">
                <t-card title="Ê∑ªÂä†Ë¥¶Âçï" class="expense-card">
                    <t-form id="expenseForm" label-width="120px">
                        <t-row :gutter="20">
                            <t-col :span="12">
                                <t-form-item label="Ê∂àË¥πÊèèËø∞">
                                    <t-input 
                                        id="expenseDesc" 
                                        placeholder="‰æãÂ¶ÇÔºöÈÖíÂ∫ó‰ΩèÂÆø"
                                        clearable
                                    />
                                </t-form-item>
                            </t-col>
                            <t-col :span="12">
                                <t-form-item label="ÈáëÈ¢ù">
                                    <t-input-number 
                                        id="expenseAmount" 
                                        placeholder="ËæìÂÖ•ÈáëÈ¢ù"
                                        :decimal-places="2"
                                        :min="0"
                                    />
                                </t-form-item>
                            </t-col>
                        </t-row>
                        
                        <t-row :gutter="20">
                            <t-col :span="12">
                                <t-form-item label="ÊîØ‰ªò‰∫∫">
                                    <t-select 
                                        id="expensePayer" 
                                        placeholder="ÈÄâÊã©ÊîØ‰ªò‰∫∫"
                                        clearable
                                    >
                                        <t-option value="" label="ÈÄâÊã©ÊîØ‰ªò‰∫∫" disabled />
                                    </t-select>
                                </t-form-item>
                            </t-col>
                            <t-col :span="12">
                                <t-form-item label="Ê∂àË¥πÂàÜÁ±ª">
                                    <t-select id="expenseCategory" v-model="category">
                                        <t-option value="‰∫§ÈÄö" label="üöó ‰∫§ÈÄö" />
                                        <t-option value="‰ΩèÂÆø" label="üè® ‰ΩèÂÆø" />
                                        <t-option value="È§êÈ•Æ" label="üçΩÔ∏è È§êÈ•Æ" />
                                        <t-option value="Ë¥≠Áâ©" label="üõçÔ∏è Ë¥≠Áâ©" />
                                        <t-option value="Èó®Á•®" label="üé´ Èó®Á•®" />
                                        <t-option value="Â®±‰πê" label="üéÆ Â®±‰πê" />
                                        <t-option value="ÂÖ∂‰ªñ" label="üì¶ ÂÖ∂‰ªñ" />
                                    </t-select>
                                </t-form-item>
                            </t-col>
                        </t-row>
                        
                        <t-form-item label="Ë¥ßÂ∏ÅÁ±ªÂûã">
                            <t-radio-group id="currencyGroup" variant="default-filled">
                                <t-radio value="CNY">CNY (¬•)</t-radio>
                                <t-radio value="USD">USD ($)</t-radio>
                                <t-radio value="EUR">EUR (‚Ç¨)</t-radio>
                                <t-radio value="JPY">JPY (¬•)</t-radio>
                                <t-radio value="KRW">KRW (‚Ç©)</t-radio>
                                <t-radio value="THB">THB (‡∏ø)</t-radio>
                            </t-radio-group>
                        </t-form-item>
                        
                        <t-form-item label="ÂΩìÂâçÊ±áÁéá">
                            <t-input-number 
                                id="exchangeRate" 
                                :value="1"
                                :decimal-places="4"
                                :min="0"
                                placeholder="ËæìÂÖ•Ê±áÁéá"
                            />
                            <span class="rate-hint">1 Â§ñÂ∏Å = ? ‰∫∫Ê∞ëÂ∏Å</span>
                        </t-form-item>
                        
                        <t-form-item label="ÂàÜË¥¶Ê®°Âºè">
                            <t-radio-group id="splitModeGroup" variant="default-filled">
                                <t-radio value="equal">ÂùáÊëä</t-radio>
                                <t-radio value="proportional">ÊåâÊØî‰æã</t-radio>
                                <t-radio value="custom">ÊåáÂÆö‰∫∫</t-radio>
                            </t-radio-group>
                        </t-form-item>
                        
                        <t-form-item label="ÂèÇ‰∏éÊàêÂëò">
                            <t-checkbox-group id="expenseMembers">
                                <t-empty description="ËØ∑ÂÖàÊ∑ªÂä†ÊàêÂëò" />
                            </t-checkbox-group>
                        </t-form-item>
                        
                        <t-form-item label="ÊØî‰æãÂàÜÈÖç" id="proportionalInputs" style="display: none;">
                            <div id="proportionalList" class="proportional-list"></div>
                        </t-form-item>
                        
                        <t-form-item>
                            <t-button theme="primary" size="large" onclick="addExpense()" block>
                                <template #icon><i class="fas fa-plus"></i></template>
                                Ê∑ªÂä†Ë¥¶Âçï
                            </t-button>
                        </t-form-item>
                    </t-form>
                </t-card>

                <!-- Ë¥¶ÂçïÂàóË°® -->
                <t-card title="Ë¥¶ÂçïÂàóË°®">
                    <div id="expenseList" class="expense-list">
                        <t-empty description="ÊöÇÊó†Ë¥¶Âçï">
                            <template #image><i class="fas fa-inbox"></i></template>
                        </t-empty>
                    </div>
                </t-card>
            </t-tab-panel>

            <t-tab-panel value="settlement" label="ÁªìÁÆó">
                <!-- ÊÄªËßàÂç°Áâá -->
                <t-card class="summary-card">
                    <t-row :gutter="20">
                        <t-col :span="8">
                            <t-statistic title="ÊÄªÊ∂àË¥π" :value="totalAmount" suffix="ÂÖÉ" />
                        </t-col>
                        <t-col :span="8">
                            <t-statistic title="Ë¥¶ÂçïÊï∞" :value="totalExpenses" />
                        </t-col>
                        <t-col :span="8">
                            <t-statistic title="‰∫∫ÂùáÊ∂àË¥π" :value="perPersonAmount" suffix="ÂÖÉ" />
                        </t-col>
                    </t-row>
                </t-card>

                <!-- ÂàÜÁ±ªÁªüËÆ° -->
                <t-card title="ÂàÜÁ±ªÁªüËÆ°" class="stats-card">
                    <t-row :gutter="16">
                        <t-col :span="6">
                            <div class="stat-item">
                                <i class="fas fa-car stat-icon"></i>
                                <div class="stat-content">
                                    <div class="stat-label">‰∫§ÈÄö</div>
                                    <div class="stat-value" id="statTransport">¬•0.00</div>
                                </div>
                            </div>
                        </t-col>
                        <t-col :span="6">
                            <div class="stat-item">
                                <i class="fas fa-hotel stat-icon"></i>
                                <div class="stat-content">
                                    <div class="stat-label">‰ΩèÂÆø</div>
                                    <div class="stat-value" id="statAccommodation">¬•0.00</div>
                                </div>
                            </div>
                        </t-col>
                        <t-col :span="6">
                            <div class="stat-item">
                                <i class="fas fa-utensils stat-icon"></i>
                                <div class="stat-content">
                                    <div class="stat-label">È§êÈ•Æ</div>
                                    <div class="stat-value" id="statFood">¬•0.00</div>
                                </div>
                            </div>
                        </t-col>
                        <t-col :span="6">
                            <div class="stat-item">
                                <i class="fas fa-shopping-bag stat-icon"></i>
                                <div class="stat-content">
                                    <div class="stat-label">Ë¥≠Áâ©</div>
                                    <div class="stat-value" id="statShopping">¬•0.00</div>
                                </div>
                            </div>
                        </t-col>
                    </t-row>
                </t-card>

                <!-- ÂÄ∫Âä°ÁΩëÁªú -->
                <t-card title="ÂÄ∫Âä°ÁΩëÁªú">
                    <div id="debtNetwork" class="debt-network">
                        <t-empty description="ÊâÄÊúâÊàêÂëòÈÉΩÂ∑≤ÁªìÊ∏Ö">
                            <template #image><i class="fas fa-check-circle"></i></template>
                        </t-empty>
                    </div>
                </t-card>
            </t-tab-panel>

            <t-tab-panel value="export" label="ÂØºÂá∫">
                <t-card title="ÂØºÂá∫ÂíåÂàÜ‰∫´">
                    <t-row :gutter="20">
                        <t-col :span="8">
                            <div class="export-option" onclick="exportPDF()">
                                <i class="fas fa-file-pdf export-icon"></i>
                                <h4>ÂØºÂá∫ PDF</h4>
                                <p>ÁîüÊàê‰∏ì‰∏öÁöÑÁªìÁÆóÊä•Âëä</p>
                            </div>
                        </t-col>
                        <t-col :span="8">
                            <div class="export-option" onclick="exportImage()">
                                <i class="fas fa-image export-icon"></i>
                                <h4>ÂØºÂá∫ÂõæÁâá</h4>
                                <p>ÁîüÊàêÂõæÁâá‰æø‰∫éÂàÜ‰∫´</p>
                            </div>
                        </t-col>
                        <t-col :span="8">
                            <div class="export-option" onclick="showShareModal()">
                                <i class="fas fa-link export-icon"></i>
                                <h4>ÂàÜ‰∫´ÈìæÊé•</h4>
                                <p>ÁîüÊàêÈÇÄËØ∑ÈìæÊé•</p>
                            </div>
                        </t-col>
                    </t-row>

                    <!-- È¢ÑËßàÂå∫Âüü -->
                    <div id="exportPreview" class="preview-container" style="display: none;">
                        <h3><i class="fas fa-eye"></i> È¢ÑËßà</h3>
                        <div id="previewContent" class="preview-content"></div>
                    </div>
                </t-card>
            </t-tab-panel>
        </t-tabs>
    </div>

    <!-- ÂàÜ‰∫´ÂØπËØùÊ°Ü -->
    <t-dialog
        id="shareDialog"
        header="ÂàÜ‰∫´ÊóÖË°å"
        width="500px"
        :visible="false"
        :confirm-btn="null"
        @close="closeShareModal"
    >
        <t-form label-width="80px">
            <t-form-item label="ÂàÜ‰∫´ÈìæÊé•">
                <t-input id="shareLink" readonly>
                    <template #suffix>
                        <t-button variant="text" onclick="copyLink()">
                            <i class="fas fa-copy"></i>
                        </t-button>
                    </template>
                </t-input>
            </t-form-item>
        </t-form>
        
        <div class="share-buttons">
            <t-button theme="success" block onclick="shareWeChat()">
                <template #icon><i class="fab fa-weixin"></i></template>
                ÂæÆ‰ø°ÂàÜ‰∫´
            </t-button>
            <t-button theme="primary" block onclick="shareEmail()">
                <template #icon><i class="fas fa-envelope"></i></template>
                ÈÇÆ‰ª∂ÂàÜ‰∫´
            </t-button>
            <t-button theme="default" block onclick="copyLink()">
                <template #icon><i class="fas fa-copy"></i></template>
                Â§çÂà∂ÈìæÊé•
            </t-button>
        </div>
    </t-dialog>

    <!-- Ê∂àÊÅØÊèêÁ§∫ -->
    <t-message id="message" />

    <!-- Âä†ËΩΩ TDesign ÁªÑ‰ª∂Â∫ì -->
    <script src="https://cdn.jsdelivr.net/npm/tdesign@1.9.0/dist/tdesign.min.js"></script>
    
    <!-- Âä†ËΩΩËá™ÂÆö‰πâ JavaScript -->
    <script src="travel-expense-tracker.js"></script>
</body>
</html>
